{% extends "base.html" %}

{% block page_name %}Projects{% endblock page_name %}

{% block page_content %}
    <!-- Główny kontener z lekkim tłem off-white i dodatkowymi odstępami -->
    <div class="container py-5" style="max-width: 1200px; background-color: #f2e9e4;">
        <!-- Formularz wyszukiwania z przyciskiem 'Clear Filters' -->
        <form class="mb-4 d-flex align-items-center" method="get" style="margin-top: 20px; max-width: 600px; margin-left: auto; margin-right: auto;">
            <input type="text" name="q" value="{{ query }}" class="form-control me-2" placeholder="Search projects..." style="flex: 1; min-width: 300px;">
            <button type="submit" class="btn btn-primary me-2">Search</button>
            {% if query or request.GET.tag %}
                <a href="?" class="btn btn-outline-secondary">Clear Filters</a>
            {% endif %}
        </form>

        <!-- Pasek z tagami do filtrowania -->
        <div class="mb-4 text-center">
            {% for tag in tags %}
                <a href="?tag={{ tag.name }}" class="btn btn-outline-info me-2">{{ tag.name|upper }}</a>
            {% endfor %}
        </div>

        <!-- Rząd z projektami: dwa elementy w rzędzie, ostatni wyśrodkowany, gdy nieparzysta liczba -->
        <div class="row justify-content-start mt-4 g-4">
            {% for project in projects %}
              <div class="col-12 col-md-6 col-lg-4 mb-4">
                <div class="card shadow-sm h-100">
                  {% if project.thumbnail %}
                    <img src="{{ project.thumbnail.url }}" 
                         class="card-img-top" 
                         alt="{{ project.title }}"
                         style="height: 200px; object-fit: cover;">
                  {% else %}
                    <img src="https://via.placeholder.com/300x200" 
                         class="card-img-top" 
                         alt="Brak miniaturki"
                         style="height: 200px; object-fit: cover;">
                  {% endif %}
                  <div class="card-body d-flex flex-column">
                    <h5 class="card-title">
                      <a href="{% url 'project_detail' project.id %}" 
                         class="text-decoration-none text-dark">{{ project.title }}</a>
                    </h5>
                    <p class="card-text flex-grow-1">{{ project.short_description|safe }}</p>
                    <div class="mt-auto">
                      {% for tag in project.tags.all %}
                        <a href="?tag={{ tag.name }}" 
                           class="badge bg-secondary text-uppercase me-1 mb-1">{{ tag.name }}</a>
                      {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
    </div>
{% endblock page_content %}
